<!DOCTYPE html>
<html lang="pt" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Nova versão do AdGuardHome e listas externas de bloqueios | .blog</title>
<meta name="keywords" content="AdGuardHome, DNS, Git, Software Livre, Open-Source, Código Fonte, resolver, unbound, DNS resolver" />
<meta name="description" content="A compilação da nova versão teve uns contratempos mas foi uma oportunidade para adicionar mais listas de bloqueio">
<meta name="author" content="Bruno Miguel">
<link rel="canonical"
    href="https://blog.brunomiguel.net/post/adguard/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.1b875647e441a9cb4f649fc226f068873d3a8abb6c4b072be76e53ffa4b5ef4e.css" integrity="sha256-G4dWR&#43;RBqctPZJ/CJvBohz06irtsSwcr525T/6S1704="
    rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js" integrity="sha256-uVus3DnjejMqn4g7Hni&#43;Srwf3KK8HyZB9V4809q9TWE="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://blog.brunomiguel.net/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16"
    href="https://blog.brunomiguel.net/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32"
    href="https://blog.brunomiguel.net/favicon-32x32.png">
<link rel="apple-touch-icon"
    href="https://blog.brunomiguel.net/apple-touch-icon.png">
<link rel="mask-icon" href="https://blog.brunomiguel.net/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }
    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }
    </style>
</noscript><link rel="preload" href="/fonts/rubik-v14-latin-300.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/rubik-v14-latin-300.woff" as="font" type="font/woff" crossorigin>

<link rel="preload" href="/fonts/rubik-v14-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/rubik-v14-latin-regular.woff" as="font" type="font/woff" crossorigin>

<link rel="preload" href="/fonts/rubik-v14-latin-700.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/rubik-v14-latin-700.woff" as="font" type="font/woff" crossorigin>

<link rel="preload" href="/fonts/rubik-v14-latin-300italic.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/rubik-v14-latin-300italic.woff" as="font" type="font/woff" crossorigin>

<link rel="preload" href="/fonts/rubik-v14-latin-italic.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/rubik-v14-latin-italic.woff" as="font" type="font/woff" crossorigin>

<link rel="preload" href="/fonts/rubik-v14-latin-700italic.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/rubik-v14-latin-700italic.woff" as="font" type="font/woff" crossorigin>


<script data-goatcounter="https://blog-brunomiguel.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>


<script defer data-domain="blog.brunomiguel.net" src="https://plausible.matterho.st/js/plausible.js"></script><div id="cookie-notice">
    <span>Este site usa cookies do GoatCounter e do Plausible, dois softwares de código aberto, para estatísticas.</span>
    <a id="cookie-notice-close" class="btn btn-primary btn-sm">Fechar</a>
    <a href="/privacidade" class="btn btn-primary btn-sm">Mais info</a></div>
    <script>
        function createCookie(name,value,days) {
            var expires = "";
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days*24*60*60*1000));
                expires = "; expires=" + date.toUTCString();
            }
            document.cookie = name + "=" + value + expires + "; path=/";
        }
        function readCookie(name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for(var i=0;i < ca.length;i++) {
                var c = ca[i];
                while (c.charAt(0)==' ') c = c.substring(1,c.length);
                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
            }
            return null;
        }
        function eraseCookie(name) {
            createCookie(name,"",-1);
        }
    
        if(readCookie('cookie-notice-option')=='true') {
            
    
            
        } else if (readCookie('cookie-notice-option')!='false'){
            document.getElementById('cookie-notice').style.display = 'block';
        }
    
        document.getElementById('cookie-notice-close').addEventListener("click",function() {
            createCookie('cookie-notice-option','true',31);
            document.getElementById('cookie-notice').style.display = 'none';
            location.reload();
        });
    
    </script><meta property="og:title" content="Nova versão do AdGuardHome e listas externas de bloqueios" />
<meta property="og:description" content="A compilação da nova versão teve uns contratempos mas foi uma oportunidade para adicionar mais listas de bloqueio" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.brunomiguel.net/post/adguard/" /><meta property="og:image" content="https://blog.brunomiguel.net/papermod-cover.png"/><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-02-24T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-02-24T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://blog.brunomiguel.net/papermod-cover.png"/>

<meta name="twitter:title" content="Nova versão do AdGuardHome e listas externas de bloqueios"/>
<meta name="twitter:description" content="A compilação da nova versão teve uns contratempos mas foi uma oportunidade para adicionar mais listas de bloqueio"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://blog.brunomiguel.net/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Nova versão do AdGuardHome e listas externas de bloqueios",
      "item": "https://blog.brunomiguel.net/post/adguard/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Nova versão do AdGuardHome e listas externas de bloqueios",
  "name": "Nova versão do AdGuardHome e listas externas de bloqueios",
  "description": "A compilação da nova versão teve uns contratempos mas foi uma oportunidade para adicionar mais listas de bloqueio",
  "keywords": [
    "AdGuardHome", "DNS", "Git", "Software Livre", "Open-Source", "Código Fonte", "resolver", "unbound", "DNS resolver"
  ],
  "articleBody": "Há mais de um ano que uso o unbound como DNS resolver local. Esta é uma boa forma de poder abstrair a gestão dos servidores de DNS usados no meu portátil, sem ter de passar a vida a editar o /etc/resolv.conf ou a lutar contra aplicações como o systemd-resolvconf e o network-manager.\nA configuração ativa que tenho no unbound é a que se segue:\nserver: access-control: 127.0.0.0/8 allow access-control: ::1/128 allow interface: :: interface: 0.0.0.0 do-ip4: yes do-ip6: yes do-udp: yes do-tcp: yes aggressive-nsec: yes cache-max-ttl: 14400 cache-min-ttl: 300 hide-identity: yes hide-version: yes minimal-responses: yes prefetch: yes qname-minimisation: yes rrset-roundrobin: yes use-caps-for-id: yes verbosity: 0 tls-upstream: yes tls-cert-bundle: /etc/ssl/certs/ca-certificates.crt forward-zone: name: \".\" forward-tls-upstream: yes forward-first: no # do NOT send direct # Quad 9 DNS - default forward-addr: 9.9.9.9@853#dns.quad9.net forward-addr: 149.112.112.112@853#dns.quad9.net forward-addr: 2620:fe::fe@853#dns.quad9.net forward-addr: 2620:fe::9@853#dns.quad9.net # Quad9 DNS - unfiltered #forward-addr: 9.9.9.10@853#quad9.net #forward-addr: 149.112.112.10@853#quad9.net #forward-addr: 2620:fe::10@853#quad9.net #forward-addr: 2620:fe::fe:10@853#quad9.net # AdGuard DNS #forward-addr: 94.140.14.140@853#dns-unfiltered.adguard.com #forward-addr: 94.140.15.15@853#dns-unfiltered.adguard.com #forward-addr: 2a10:50c0::1:ff@853#dns-unfiltered.adguard.com #forward-addr: 2a10:50c0::2:ff@853#dns-unfiltered.adguard.com # Cloudflare DNS #forward-addr: 2606:4700:4700::1111@853#cloudflare-dns.com #forward-addr: 1.1.1.1@853#cloudflare-dns.com #forward-addr: 2606:4700:4700::1001@853#cloudflare-dns.com #forward-addr: 1.0.0.1@853#cloudflare-dns.com No entanto, já há algum tempo que tinha curiosidade em testar o AdGuardHome. A funcionalidade de adblocker interessou-me bastante e parece-me uma boa forma de impedir que alguns scripts de tracking cheguem, não só ao browser, mas às aplicações como o Discord e outras potencialmente problemáticas no que toca à privacidade.\nExiste também uma funcionalidade que permite usar o AdGuardHome como servidor DHCP. Como pretendo utilizá-lo apenas no meu portátil, esta não me interessa. Quem tem um computador ou uma SoC para atribuir IPs na rede pode ter interesse nela, ao mesmo tempo que bloqueia algum tracking.\nInstalação Usar binário pré-compilado O projeto tem releases binárias para além do código-fonte no Github. Sempre que uma nova versão é tagada, os binários para diferentes sistemas operativos e arquiteturas de hardware são colocados na secção de releases do repositório. A forma mais simples de usar o AdGuardHome é descarregar uma destas releases, descompactar e correr a aplicação como root.\nsudo ./AdGuardHome Usar estes binários não torna a ativação persistente. Para isso é necessário abrir um terminal, ir até à pasta onde está o binário e usar o comando sudo ./AdGuardHome -s install. Ao fazeres isto, o binário é colocado em /var/lib/adguardhome, o serviço do systemd é instalado e o seu estado passa a poder ser controlado pelo systemctl se preferires este interface.\nSempre que sair uma versão nova, tens de a descarregar e voltar a correr o comando de instalação sudo ./AdGuardHome -s install.\nCompilar o código-fonte A compilação do AdGuardHome pode ser feita de duas formas: usando o código-fonte de uma release específica ou a brach master do repositório git. Qualquer que seja a tua opção, deves garantir que todas as dependências estão instaladas. Tudo o que é necessário está no README.md.\nPosto isto, basta apenas executar o make na pasta do código-fonte.\nCaso pretendas compilar apenas o binário para o teu sistema operativo e arquitetura específica, podes complementar o make da seguinte forma:\nmake GOOS='linux' GOARCH='amd64' No exemplo acima, o binário vai ser compilado para Linux e processadores x86_64. Se tiveres um rPI ou uma SoC idêntica, podes trocar amd64 por arm64 ou arm7, por exemplo. O scripts/make/build-release.sh tem a listagem dos sistemas operativos e arquiteturas de hadware suportadas. Se quiseres dar uma vista de olhos, aquele é o ficheiro a consultar obrigatoriamente.\nO binário criado fica na raiz da pasta com o código-fonte. Para o tornar persistente, tal como na opção anterior, é necessário usares o comando sudo ./AdGuardHome -s install. Como no exemplo anterior, o binário é colocado em /var/lib/adguardhome, o serviço do systemd é instalado e o seu estado passa a poder ser controlado pelo systemctl se preferires este interface.\nSempre que atualizares o repositório para um commit mais recente, tens de recompilar e correr novamente o comando de instalação sudo ./AdGuardHome -s install.\nConfiguração A configuração do AdGuardHome é simples. Quando o abres pela primeira vez, dá-te o endereço para abrires no browser e mostra um assistente de configuração simples. Basta seguires os poucos passos do processo e ficas com os defaults, que deverão ser suficientes.\nSe pretenderes mais listas de bloqueio, o interface web permite escolher várias pré-definidas e adicionar externas. Eu fiz um pequeno port da minha lista Antinónio para o AdGuardHome, se estiveres interessado.\nÉ possível, contúdo, que tenhas de adicionar exceções à lista de bloqueios através do interface web da aplicação. Eu só fui forçado a fazê-lo uma vez depois de adicionar mais listas, apenas para não ter acesso bloqueado ao endereço das estatísticas deste blog, o goatcounter.com. A lista que contém o bloqueio barra tudo desse domínio.\nConclusão Isto é uma introdução muito simples ao processo de instalação do AdGuardHome e assume que estás minimamente à vontade com um terminal. Se não for o teu caso, é melhor leres a documentação do projeto.\nA imagem deste post é um screenshot da minha instalação do AdGuardHome e está disponível sob a licença Creative Commons (CC-BY-SA-4.0)\n",
  "wordCount" : "823",
  "inLanguage": "pt",
  "datePublished": "2022-02-24T00:00:00Z",
  "dateModified": "2022-02-24T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Bruno Miguel"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://blog.brunomiguel.net/post/adguard/"
  },
  "publisher": {
    "@type": "Organization",
    "name": ".blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://blog.brunomiguel.net/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.brunomiguel.net" accesskey="h" title=".blog (Alt + H)">.blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blog.brunomiguel.net/search/" title="Pesquisa">
                    <span>Pesquisa</span>
                </a>
            </li>
            <li>
                <a href="https://blog.brunomiguel.net/arquivo" title="Arquivo">
                    <span>Arquivo</span>
                </a>
            </li>
            <li>
                <a href="https://blog.brunomiguel.net/categories/" title="Categorias">
                    <span>Categorias</span>
                </a>
            </li>
            <li>
                <a href="https://blog.brunomiguel.net/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://blog.brunomiguel.net/privacidade/" title="Privacidade">
                    <span>Privacidade</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Nova versão do AdGuardHome e listas externas de bloqueios
    </h1>
    
    <div class="post-meta"><span title='2022-02-24 00:00:00 +0000 UTC'>fevereiro 24, 2022</span>&nbsp;·&nbsp;4 minutos&nbsp;·&nbsp;Bruno Miguel

</div>
  </header> 
<figure class="entry-cover">
    
    <img src="https://blog.brunomiguel.net/post/adguard/images/adguardhome.png">
</figure>


  <div class="post-content"><p>Há mais de um ano que uso o <em>unbound</em> como <em>DNS resolver</em> local. Esta é uma boa forma de poder abstrair a gestão dos servidores de <em>DNS</em> usados no meu portátil, sem ter de passar a vida a editar o <code>/etc/resolv.conf</code> ou a lutar contra aplicações como o <em>systemd-resolvconf</em> e o <em>network-manager</em>.</p>
<p>A configuração ativa que tenho no <em>unbound</em> é a que se segue:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">server</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">access-control</span><span class="p">:</span><span class="w"> </span><span class="m">127.0.0.0</span><span class="l">/8 allow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">access-control</span><span class="p">:</span><span class="w"> </span><span class="p">::</span><span class="m">1</span><span class="l">/128 allow</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">interface</span><span class="p">:</span><span class="w"> </span><span class="nt">:</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">interface</span><span class="p">:</span><span class="w"> </span><span class="m">0.0.0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">do-ip4</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">do-ip6</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">do-udp</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">do-tcp</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">aggressive-nsec</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cache-max-ttl</span><span class="p">:</span><span class="w"> </span><span class="m">14400</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cache-min-ttl</span><span class="p">:</span><span class="w"> </span><span class="m">300</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">hide-identity</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">hide-version</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">minimal-responses</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">prefetch</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">qname-minimisation</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rrset-roundrobin</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">use-caps-for-id</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">verbosity</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tls-upstream</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tls-cert-bundle</span><span class="p">:</span><span class="w"> </span><span class="l">/etc/ssl/certs/ca-certificates.crt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">forward-zone</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;.&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">forward-tls-upstream</span><span class="p">:</span><span class="w"> </span><span class="kc">yes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">forward-first</span><span class="p">:</span><span class="w"> </span><span class="kc">no</span><span class="w"> </span><span class="c"># do NOT send direct</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c"># Quad 9 DNS - default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">forward-addr</span><span class="p">:</span><span class="w"> </span><span class="m">9.9.9.9</span>@<span class="m">853</span><span class="c">#dns.quad9.net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">forward-addr</span><span class="p">:</span><span class="w"> </span><span class="m">149.112.112.112</span>@<span class="m">853</span><span class="c">#dns.quad9.net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">forward-addr</span><span class="p">:</span><span class="w"> </span><span class="m">2620</span><span class="p">:</span><span class="l">fe::fe@853#dns.quad9.net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nt">forward-addr</span><span class="p">:</span><span class="w"> </span><span class="m">2620</span><span class="p">:</span><span class="l">fe::9@853#dns.quad9.net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c"># Quad9 DNS - unfiltered</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c">#forward-addr: 9.9.9.10@853#quad9.net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c">#forward-addr: 149.112.112.10@853#quad9.net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c">#forward-addr: 2620:fe::10@853#quad9.net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c">#forward-addr: 2620:fe::fe:10@853#quad9.net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c"># AdGuard DNS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c">#forward-addr: 94.140.14.140@853#dns-unfiltered.adguard.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c">#forward-addr: 94.140.15.15@853#dns-unfiltered.adguard.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c">#forward-addr: 2a10:50c0::1:ff@853#dns-unfiltered.adguard.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c">#forward-addr: 2a10:50c0::2:ff@853#dns-unfiltered.adguard.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c"># Cloudflare DNS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c">#forward-addr: 2606:4700:4700::1111@853#cloudflare-dns.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c">#forward-addr: 1.1.1.1@853#cloudflare-dns.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c">#forward-addr: 2606:4700:4700::1001@853#cloudflare-dns.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c">#forward-addr: 1.0.0.1@853#cloudflare-dns.com</span><span class="w">
</span></span></span></code></pre></div><p>No entanto, já há algum tempo que tinha curiosidade em testar o <em>AdGuardHome</em>. A funcionalidade de <em>adblocker</em> interessou-me bastante e parece-me uma boa forma de impedir que alguns <em>scripts</em> de <em>tracking</em> cheguem, não só ao <em>browser</em>, mas às aplicações como o <em>Discord</em> e outras potencialmente problemáticas no que toca à privacidade.</p>
<p>Existe também uma funcionalidade que permite usar o <em>AdGuardHome</em> como servidor <em>DHCP</em>. Como pretendo utilizá-lo apenas no meu portátil, esta não me interessa. Quem tem um computador ou uma <em>SoC</em> para atribuir <em>IPs</em> na rede pode ter interesse nela, ao mesmo tempo que bloqueia algum <em>tracking</em>.</p>
<h1 id="instalação">Instalação<a hidden class="anchor" aria-hidden="true" href="#instalação">#</a></h1>
<h2 id="usar-binário-pré-compilado">Usar binário pré-compilado<a hidden class="anchor" aria-hidden="true" href="#usar-binário-pré-compilado">#</a></h2>
<p>O projeto tem <em>releases</em> binárias para além do código-fonte no <em>Github</em>. Sempre que uma nova versão é <em>tagada</em>, os binários para diferentes sistemas operativos e arquiteturas de <em>hardware</em> são colocados na <a href="https://github.com/AdguardTeam/AdGuardHome/releases">secção de <em>releases</em> do repositório</a>. A forma mais simples de usar o <em>AdGuardHome</em> é descarregar uma destas <em>releases</em>, descompactar e correr a aplicação como <em>root</em>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo ./AdGuardHome
</span></span></code></pre></div><p>Usar estes binários não torna a ativação persistente. Para isso é necessário abrir um terminal, ir até à pasta onde está o binário e usar o comando <code>sudo ./AdGuardHome -s install</code>. Ao fazeres isto, o binário é colocado em <code>/var/lib/adguardhome</code>, o serviço do <em>systemd</em> é instalado e o seu estado passa a poder ser controlado pelo <code>systemctl</code> se preferires este interface.</p>
<p>Sempre que sair uma versão nova, tens de a descarregar e voltar a correr o comando de instalação <code>sudo ./AdGuardHome -s install</code>.</p>
<h2 id="compilar-o-código-fonte">Compilar o código-fonte<a hidden class="anchor" aria-hidden="true" href="#compilar-o-código-fonte">#</a></h2>
<p>A compilação do <em>AdGuardHome</em> pode ser feita de duas formas: usando o código-fonte de uma <em><a href="https://github.com/AdguardTeam/AdGuardHome/releases">release</a></em> específica ou a <em>brach master</em> do repositório <em>git</em>. Qualquer que seja a tua opção, deves garantir que todas as dependências estão instaladas. Tudo o que é necessário está no <a href="https://github.com/AdguardTeam/AdGuardHome#how-to-build"><em>README.md</em></a>.</p>
<p>Posto isto, basta apenas executar o <code>make</code> na pasta do código-fonte.</p>
<p>Caso pretendas compilar apenas o binário para o teu sistema operativo e arquitetura específica, podes complementar o <code>make</code> da seguinte forma:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">make <span class="nv">GOOS</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span> <span class="nv">GOARCH</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span>
</span></span></code></pre></div><p>No exemplo acima, o binário vai ser compilado para <em>Linux</em> e processadores <em>x86_64</em>. Se tiveres um <em>rPI</em> ou uma <em>SoC</em> idêntica, podes trocar <code>amd64</code> por <code>arm64</code> ou <code>arm7</code>, por exemplo. O <em><a href="scripts/make/build-release.sh">scripts/make/build-release.sh</a></em> tem a listagem dos sistemas operativos e arquiteturas de <em>hadware</em> suportadas. Se quiseres dar uma vista de olhos, aquele é o ficheiro a consultar obrigatoriamente.</p>
<p>O binário criado fica na raiz da pasta com o código-fonte. Para o tornar persistente, tal como na opção anterior, é necessário usares o comando <code>sudo ./AdGuardHome -s install</code>. Como no exemplo anterior, o binário é colocado em <code>/var/lib/adguardhome</code>, o serviço do <em>systemd</em> é instalado e o seu estado passa a poder ser controlado pelo <code>systemctl</code> se preferires este interface.</p>
<p>Sempre que atualizares o repositório para um <em>commit</em> mais recente, tens de recompilar e correr novamente o comando de instalação <code>sudo ./AdGuardHome -s install</code>.</p>
<h1 id="configuração">Configuração<a hidden class="anchor" aria-hidden="true" href="#configuração">#</a></h1>
<p>A configuração do <em>AdGuardHome</em> é simples. Quando o abres pela primeira vez, dá-te o endereço para abrires no <em>browser</em> e mostra um assistente de configuração simples. Basta seguires os poucos passos do processo e ficas com os <em>defaults</em>, que deverão ser suficientes.</p>
<p>Se pretenderes mais listas de bloqueio, o <em>interface web</em> permite escolher várias pré-definidas e adicionar externas. Eu fiz um pequeno <em><a href="https://raw.githubusercontent.com/brunomiguel/antinonio/master/antinonio-adguard.txt">port</a></em> da minha lista <em>Antinónio</em> para o <em>AdGuardHome</em>, se estiveres interessado.</p>
<p>É possível, contúdo, que tenhas de adicionar exceções à lista de bloqueios através do <em>interface web</em> da aplicação. Eu só fui forçado a fazê-lo uma vez depois de adicionar mais listas, apenas para não ter acesso bloqueado ao endereço das estatísticas deste <em>blog</em>, o <em>goatcounter.com</em>. A lista que contém o bloqueio barra tudo desse domínio.</p>
<h1 id="conclusão">Conclusão<a hidden class="anchor" aria-hidden="true" href="#conclusão">#</a></h1>
<p>Isto é uma introdução muito simples ao processo de instalação do <em>AdGuardHome</em> e assume que estás minimamente à vontade com um terminal. Se não for o teu caso, é melhor leres a <a href="https://github.com/AdguardTeam/AdGuardHome/wiki">documentação</a> do projeto.</p>
<p><small><em>A imagem deste post é um screenshot da minha instalação do AdGuardHome e está disponível sob a licença Creative Commons (<a href="https://creativecommons.org/licenses/by-sa/4.0/">CC-BY-SA-4.0</a>)</em></small></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://blog.brunomiguel.net/tags/adguardhome/">AdGuardHome</a></li>
      <li><a href="https://blog.brunomiguel.net/tags/dns/">DNS</a></li>
      <li><a href="https://blog.brunomiguel.net/tags/git/">Git</a></li>
      <li><a href="https://blog.brunomiguel.net/tags/software-livre/">Software Livre</a></li>
      <li><a href="https://blog.brunomiguel.net/tags/open-source/">Open-Source</a></li>
      <li><a href="https://blog.brunomiguel.net/tags/c%C3%B3digo-fonte/">Código Fonte</a></li>
      <li><a href="https://blog.brunomiguel.net/tags/resolver/">resolver</a></li>
      <li><a href="https://blog.brunomiguel.net/tags/unbound/">unbound</a></li>
      <li><a href="https://blog.brunomiguel.net/tags/dns-resolver/">DNS resolver</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://blog.brunomiguel.net/post/listas-adguardhome/">
    <span class="title">« Página Anterior</span>
    <br>
    <span>Listas de bloqueio para o …</span>
  </a>
  <a class="next" href="https://blog.brunomiguel.net/post/repositorio-cara-lavada/">
    <span class="title">Próxima Página »</span>
    <br>
    <span>Repositório com cara lavada</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span><a rel="me" href="https://masto.pt/@brunomiguel">I'm on the Fediverse</a></span><br/>
    <span> <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC-BY-SA-4.0</a> - 2022</span><br/>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a>, a customized
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod theme</a>, and an improved
        <a href="https://github.com/catppuccin/catppuccin" rel="noopener" target="_blank">Catppuccin color palette</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
